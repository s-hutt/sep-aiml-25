<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="📖 API Reference" href="../api.html" /><link rel="prev" title="Coalition-Finding Algorithmus" href="coalition_finding_algorithmus.html" />

    <link rel="shortcut icon" href="../_static/shapiq.ico"/><!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Laufzeitanalyse: SHAP vs SHAPIQ - shapiq_student 0.6.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">shapiq_student 0.6.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/logo/logo_shapiq_light.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/logo/logo_shapiq_dark.svg" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">INTRODUCTION</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">What is this project about?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/start.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EXAMPLES</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="KNN_shapley.html">KNN-Shapley</a></li>
<li class="toctree-l1"><a class="reference internal" href="conditional_data_imputers.html">Conditional Data Imputers</a></li>
<li class="toctree-l1"><a class="reference internal" href="coalition_finding_algorithmus.html">Coalition-Finding Algorithmus</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Laufzeitanalyse: SHAP vs SHAPIQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API REFERENCE</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api.html">📖 API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of 📖 API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/shapiq_student.copula.html">shapiq_student.copula</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/shapiq_student.gaussian.html">shapiq_student.gaussian</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/shapiq_student.knn_explainer.html">shapiq_student.knn_explainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/shapiq_student.beam_finder.html">shapiq_student.beam_finder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/shapiq_student.brute_force.html">shapiq_student.brute_force</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/shapiq_student.evaluation.html">shapiq_student.evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/shapiq_student.evaluation_utils.html">shapiq_student.evaluation_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/shapiq_student.subset_finding.html">shapiq_student.subset_finding</a></li>
</ul>
</li>
</ul>

</div></div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/examples/runtime_analysis_shap_vs_shapiq.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="Laufzeitanalyse:-SHAP-vs-SHAPIQ">
<h1>Laufzeitanalyse: SHAP vs SHAPIQ<a class="headerlink" href="#Laufzeitanalyse:-SHAP-vs-SHAPIQ" title="Link to this heading">¶</a></h1>
<p>Dieses Notebook vergleicht verschiedene Approximationsverfahren zur Berechnung von Shapley-Werten.</p>
<section id="Ziel">
<h2>Ziel<a class="headerlink" href="#Ziel" title="Link to this heading">¶</a></h2>
<p>Analyse von:</p>
<ul class="simple">
<li><p>Laufzeit (x-Achse)</p></li>
<li><p>Approximationsgenauigkeit (L1 &amp; L2 Fehler) gegenüber Referenzwerten</p></li>
</ul>
<section id="Verglichene-Methoden">
<h3>Verglichene Methoden<a class="headerlink" href="#Verglichene-Methoden" title="Link to this heading">¶</a></h3>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Bibliothek</p></th>
<th class="head"><p>Methode</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">shapiq</span></code></p></td>
<td><p>KernelSHAP, SVARM, PermutationSamplingSV</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">shap</span></code></p></td>
<td><p>KernelExplainer, PermutationExplainer</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="Datensätze">
<h3>Datensätze<a class="headerlink" href="#Datensätze" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Bike Sharing</p></li>
<li><p>California Housing</p></li>
</ul>
</section>
<section id="Modelle">
<h3>Modelle<a class="headerlink" href="#Modelle" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Lineare Regression</p></li>
<li><p>Random Forest Regressor</p></li>
</ul>
<p>Imports &amp; Einstellungen</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">shapiq</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shap</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapiq</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularExplainer</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<br/><br/></pre></div>
</div>
</div>
<p>Daten vorbereiten &amp; subsample Background (für schnellere Laufzeiten)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- Daten laden und vorverarbeiten ---</span>

<span class="n">X_bike</span><span class="p">,</span> <span class="n">y_bike</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_bike_sharing</span><span class="p">()</span>
<span class="n">X_cal</span><span class="p">,</span> <span class="n">y_cal</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_california_housing</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bike Sharing - X shape:&quot;</span><span class="p">,</span> <span class="n">X_bike</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;y shape:&quot;</span><span class="p">,</span> <span class="n">y_bike</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;California Housing - X shape:&quot;</span><span class="p">,</span> <span class="n">X_cal</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;y shape:&quot;</span><span class="p">,</span> <span class="n">y_cal</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">preprocess_data</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">categorical_cols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">categorical_cols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">X_processed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">categorical_cols</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cat_cols</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">X_processed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cat_cols</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">X_processed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="n">y_processed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="k">else</span> <span class="n">y</span>

    <span class="k">if</span> <span class="n">sample_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_processed</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">sample_size</span><span class="p">:</span>
        <span class="n">sampled_indices</span> <span class="o">=</span> <span class="n">X_processed</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
        <span class="n">X_processed</span> <span class="o">=</span> <span class="n">X_processed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sampled_indices</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">y_processed</span> <span class="o">=</span> <span class="n">y_processed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sampled_indices</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">X_processed</span> <span class="o">=</span> <span class="n">X_processed</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">y_processed</span> <span class="o">=</span> <span class="n">y_processed</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">X_processed</span><span class="p">,</span> <span class="n">y_processed</span>

<span class="n">bike_categorical_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;season&#39;</span><span class="p">,</span> <span class="s1">&#39;weather&#39;</span><span class="p">]</span>

<span class="n">X_bike_proc</span><span class="p">,</span> <span class="n">y_bike_proc</span> <span class="o">=</span> <span class="n">preprocess_data</span><span class="p">(</span><span class="n">X_bike</span><span class="p">,</span> <span class="n">y_bike</span><span class="p">,</span> <span class="n">categorical_cols</span><span class="o">=</span><span class="n">bike_categorical_cols</span><span class="p">)</span>
<span class="n">X_cal_proc</span><span class="p">,</span> <span class="n">y_cal_proc</span> <span class="o">=</span> <span class="n">preprocess_data</span><span class="p">(</span><span class="n">X_cal</span><span class="p">,</span> <span class="n">y_cal</span><span class="p">)</span>

<span class="n">sample_fraction</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="n">X_bike_proc_sampled</span> <span class="o">=</span> <span class="n">X_bike_proc</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="n">sample_fraction</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">y_bike_proc_sampled</span> <span class="o">=</span> <span class="n">y_bike_proc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">X_bike_proc_sampled</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

<span class="n">X_cal_proc_sampled</span> <span class="o">=</span> <span class="n">X_cal_proc</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="n">sample_fraction</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">y_cal_proc_sampled</span> <span class="o">=</span> <span class="n">y_cal_proc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">X_cal_proc_sampled</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sampled preprocessed Bike Sharing shape:&quot;</span><span class="p">,</span> <span class="n">X_bike_proc_sampled</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sampled preprocessed California Housing shape:&quot;</span><span class="p">,</span> <span class="n">X_cal_proc_sampled</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Bike Sharing - X shape: (17379, 12) y shape: (17379,)
California Housing - X shape: (20640, 8) y shape: (20640,)
Sampled preprocessed Bike Sharing shape: (1738, 16)
Sampled preprocessed California Housing shape: (2064, 8)
</pre></div></div>
</div>
<p>Modelle trainieren</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- Train-Test Split ---</span>

<span class="n">Xb_train</span><span class="p">,</span> <span class="n">Xb_test</span><span class="p">,</span> <span class="n">yb_train</span><span class="p">,</span> <span class="n">yb_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_bike_proc_sampled</span><span class="p">,</span> <span class="n">y_bike_proc_sampled</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>
<span class="n">Xc_train</span><span class="p">,</span> <span class="n">Xc_test</span><span class="p">,</span> <span class="n">yc_train</span><span class="p">,</span> <span class="n">yc_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_cal_proc_sampled</span><span class="p">,</span> <span class="n">y_cal_proc_sampled</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># --- Modelle trainieren ---</span>

<span class="n">model_bike_rf</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">model_bike_rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xb_train</span><span class="p">,</span> <span class="n">yb_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bike Sharing RandomForestRegressor trainiert.&quot;</span><span class="p">)</span>

<span class="n">model_cal_rf</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">model_cal_rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xc_train</span><span class="p">,</span> <span class="n">yc_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;California Housing RandomForestRegressor trainiert.&quot;</span><span class="p">)</span>

<span class="n">model_bike_lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model_bike_lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xb_train</span><span class="p">,</span> <span class="n">yb_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bike Sharing LinearRegression trainiert.&quot;</span><span class="p">)</span>

<span class="n">model_cal_lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model_cal_lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xc_train</span><span class="p">,</span> <span class="n">yc_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;California Housing LinearRegression trainiert.&quot;</span><span class="p">)</span>

<span class="c1"># --- Wrapper Funktion für sauberes predict mit Feature-Namen ---</span>

<span class="k">def</span><span class="w"> </span><span class="nf">model_predict_wrapper</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">feature_names</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="c1"># convert Series to DataFrame with one row</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">feature_names</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input must be DataFrame, Series, or 2D NumPy array.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">predict</span>


<span class="c1"># Feature-Namen</span>
<span class="n">feature_names_bike</span> <span class="o">=</span> <span class="n">X_bike_proc_sampled</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">feature_names_cal</span> <span class="o">=</span> <span class="n">X_cal_proc_sampled</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">n_features_bike</span> <span class="o">=</span> <span class="n">X_bike_proc_sampled</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">n_features_cal</span> <span class="o">=</span> <span class="n">X_cal_proc_sampled</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of features in bike dataset: </span><span class="si">{</span><span class="n">n_features_bike</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of features in cal dataset: </span><span class="si">{</span><span class="n">n_features_cal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Bike Sharing RandomForestRegressor trainiert.
California Housing RandomForestRegressor trainiert.
Bike Sharing LinearRegression trainiert.
California Housing LinearRegression trainiert.
Number of features in bike dataset: 16
Number of features in cal dataset: 8
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">shapiq.explainer</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">shapiq</span><span class="o">.</span><span class="n">explainer</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;AgnosticExplainer&#39;, &#39;Explainer&#39;, &#39;TabPFNExplainer&#39;, &#39;TabularExplainer&#39;, &#39;TreeExplainer&#39;, &#39;__all__&#39;, &#39;__builtins__&#39;, &#39;__cached__&#39;, &#39;__doc__&#39;, &#39;__file__&#39;, &#39;__loader__&#39;, &#39;__name__&#39;, &#39;__package__&#39;, &#39;__path__&#39;, &#39;__spec__&#39;, &#39;agnostic&#39;, &#39;base&#39;, &#39;configuration&#39;, &#39;custom_types&#39;, &#39;tabpfn&#39;, &#39;tabular&#39;, &#39;tree&#39;, &#39;utils&#39;, &#39;validation&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">shapiq.explainer.tabular</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">shapiq</span><span class="o">.</span><span class="n">explainer</span><span class="o">.</span><span class="n">tabular</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;Any&#39;, &#39;Explainer&#39;, &#39;ExplainerIndices&#39;, &#39;InteractionValues&#39;, &#39;Literal&#39;, &#39;TYPE_CHECKING&#39;, &#39;TabularExplainer&#39;, &#39;TabularExplainerApproximators&#39;, &#39;TabularExplainerImputers&#39;, &#39;TabularExplainerIndices&#39;, &#39;__builtins__&#39;, &#39;__cached__&#39;, &#39;__doc__&#39;, &#39;__file__&#39;, &#39;__loader__&#39;, &#39;__name__&#39;, &#39;__package__&#39;, &#39;__spec__&#39;, &#39;annotations&#39;, &#39;finalize_computed_interactions&#39;, &#39;overrides&#39;, &#39;setup_approximator&#39;, &#39;warn&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">shapiq.explainer.tabular</span><span class="w"> </span><span class="kn">import</span> <span class="n">TabularExplainerApproximators</span>

<span class="nb">print</span><span class="p">(</span><span class="n">TabularExplainerApproximators</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
typing.Literal[&#39;spex&#39;, &#39;montecarlo&#39;, &#39;svarm&#39;, &#39;permutation&#39;, &#39;regression&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hintergrunddaten (Background samples for explainers)</span>
<span class="n">sample_size</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Sample and reset index on original processed DataFrames</span>
<span class="n">background_bike_df</span> <span class="o">=</span> <span class="n">X_bike_proc_sampled</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">background_cal_df</span> <span class="o">=</span> <span class="n">X_cal_proc_sampled</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Convert sampled backgrounds to NumPy arrays for shapiq TabularExplainer compatibility</span>
<span class="n">background_bike_np</span> <span class="o">=</span> <span class="n">background_bike_df</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">background_cal_np</span> <span class="o">=</span> <span class="n">background_cal_df</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="c1"># --- Sanity check: Background shape vs. feature names ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bike background shape:&quot;</span><span class="p">,</span> <span class="n">background_bike_np</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bike feature names len:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_names_bike</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">background_bike_np</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_names_bike</span><span class="p">),</span> <span class="s2">&quot;Mismatch in bike background features!&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cal background shape:&quot;</span><span class="p">,</span> <span class="n">background_cal_np</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cal feature names len:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_names_cal</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">background_cal_np</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_names_cal</span><span class="p">),</span> <span class="s2">&quot;Mismatch in cal background features!&quot;</span>

<span class="c1"># Wrapped predict functions for each model &amp; feature set</span>
<span class="n">wrapped_predict_bike_rf</span> <span class="o">=</span> <span class="n">model_predict_wrapper</span><span class="p">(</span><span class="n">model_bike_rf</span><span class="p">,</span> <span class="n">feature_names_bike</span><span class="p">)</span>
<span class="n">wrapped_predict_cal_rf</span> <span class="o">=</span> <span class="n">model_predict_wrapper</span><span class="p">(</span><span class="n">model_cal_rf</span><span class="p">,</span> <span class="n">feature_names_cal</span><span class="p">)</span>
<span class="n">wrapped_predict_bike_lr</span> <span class="o">=</span> <span class="n">model_predict_wrapper</span><span class="p">(</span><span class="n">model_bike_lr</span><span class="p">,</span> <span class="n">feature_names_bike</span><span class="p">)</span>
<span class="n">wrapped_predict_cal_lr</span> <span class="o">=</span> <span class="n">model_predict_wrapper</span><span class="p">(</span><span class="n">model_cal_lr</span><span class="p">,</span> <span class="n">feature_names_cal</span><span class="p">)</span>

<span class="c1"># --- shapiq Explainers ---</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;type(background_bike_np): </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">background_bike_np</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;background_bike_np.shape: </span><span class="si">{</span><span class="n">background_bike_np</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;type(background_cal_np): </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">background_cal_np</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;background_cal_np.shape: </span><span class="si">{</span><span class="n">background_cal_np</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Bike RF shapiq explainers</span>
<span class="n">explainer_shapiq_spex_bike_rf</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">TabularExplainer</span><span class="p">(</span><span class="n">wrapped_predict_bike_rf</span><span class="p">,</span> <span class="n">background_bike_np</span><span class="p">,</span> <span class="n">approximator</span><span class="o">=</span><span class="s2">&quot;spex&quot;</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">explainer_shapiq_svarm_bike_rf</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">TabularExplainer</span><span class="p">(</span><span class="n">wrapped_predict_bike_rf</span><span class="p">,</span> <span class="n">background_bike_np</span><span class="p">,</span> <span class="n">approximator</span><span class="o">=</span><span class="s2">&quot;svarm&quot;</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">explainer_shapiq_perm_bike_rf</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">TabularExplainer</span><span class="p">(</span><span class="n">wrapped_predict_bike_rf</span><span class="p">,</span> <span class="n">background_bike_np</span><span class="p">,</span> <span class="n">approximator</span><span class="o">=</span><span class="s2">&quot;permutation&quot;</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Cal RF shapiq explainers</span>
<span class="n">explainer_shapiq_spex_cal_rf</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">TabularExplainer</span><span class="p">(</span><span class="n">wrapped_predict_cal_rf</span><span class="p">,</span> <span class="n">background_cal_np</span><span class="p">,</span> <span class="n">approximator</span><span class="o">=</span><span class="s2">&quot;spex&quot;</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">explainer_shapiq_svarm_cal_rf</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">TabularExplainer</span><span class="p">(</span><span class="n">wrapped_predict_cal_rf</span><span class="p">,</span> <span class="n">background_cal_np</span><span class="p">,</span> <span class="n">approximator</span><span class="o">=</span><span class="s2">&quot;svarm&quot;</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">explainer_shapiq_perm_cal_rf</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">TabularExplainer</span><span class="p">(</span><span class="n">wrapped_predict_cal_rf</span><span class="p">,</span> <span class="n">background_cal_np</span><span class="p">,</span> <span class="n">approximator</span><span class="o">=</span><span class="s2">&quot;permutation&quot;</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Bike LR shapiq explainers</span>
<span class="n">explainer_shapiq_spex_bike_lr</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">TabularExplainer</span><span class="p">(</span><span class="n">wrapped_predict_bike_lr</span><span class="p">,</span> <span class="n">background_bike_np</span><span class="p">,</span> <span class="n">approximator</span><span class="o">=</span><span class="s2">&quot;spex&quot;</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">explainer_shapiq_svarm_bike_lr</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">TabularExplainer</span><span class="p">(</span><span class="n">wrapped_predict_bike_lr</span><span class="p">,</span> <span class="n">background_bike_np</span><span class="p">,</span> <span class="n">approximator</span><span class="o">=</span><span class="s2">&quot;svarm&quot;</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">explainer_shapiq_perm_bike_lr</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">TabularExplainer</span><span class="p">(</span><span class="n">wrapped_predict_bike_lr</span><span class="p">,</span> <span class="n">background_bike_np</span><span class="p">,</span> <span class="n">approximator</span><span class="o">=</span><span class="s2">&quot;permutation&quot;</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Cal LR shapiq explainers</span>
<span class="n">explainer_shapiq_spex_cal_lr</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">TabularExplainer</span><span class="p">(</span><span class="n">wrapped_predict_cal_lr</span><span class="p">,</span> <span class="n">background_cal_np</span><span class="p">,</span> <span class="n">approximator</span><span class="o">=</span><span class="s2">&quot;spex&quot;</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">explainer_shapiq_svarm_cal_lr</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">TabularExplainer</span><span class="p">(</span><span class="n">wrapped_predict_cal_lr</span><span class="p">,</span> <span class="n">background_cal_np</span><span class="p">,</span> <span class="n">approximator</span><span class="o">=</span><span class="s2">&quot;svarm&quot;</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">explainer_shapiq_perm_cal_lr</span> <span class="o">=</span> <span class="n">shapiq</span><span class="o">.</span><span class="n">TabularExplainer</span><span class="p">(</span><span class="n">wrapped_predict_cal_lr</span><span class="p">,</span> <span class="n">background_cal_np</span><span class="p">,</span> <span class="n">approximator</span><span class="o">=</span><span class="s2">&quot;permutation&quot;</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># --- shap KernelExplainers (reference explainers, expect DataFrames) ---</span>
<span class="n">explainer_shap_kernel_bike_rf</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">KernelExplainer</span><span class="p">(</span><span class="n">wrapped_predict_bike_rf</span><span class="p">,</span> <span class="n">background_bike_df</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names_bike</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">explainer_shap_kernel_cal_rf</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">KernelExplainer</span><span class="p">(</span><span class="n">wrapped_predict_cal_rf</span><span class="p">,</span> <span class="n">background_cal_df</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names_cal</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">explainer_shap_kernel_bike_lr</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">KernelExplainer</span><span class="p">(</span><span class="n">wrapped_predict_bike_lr</span><span class="p">,</span> <span class="n">background_bike_df</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names_bike</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">explainer_shap_kernel_cal_lr</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">KernelExplainer</span><span class="p">(</span><span class="n">wrapped_predict_cal_lr</span><span class="p">,</span> <span class="n">background_cal_df</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names_cal</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Alle Explainer (shapiq + shap) erfolgreich initialisiert.&quot;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Bike background shape: (100, 16)
Bike feature names len: 16
Cal background shape: (100, 8)
Cal feature names len: 8
type(background_bike_np): &lt;class &#39;numpy.ndarray&#39;&gt;
background_bike_np.shape: (100, 16)
type(background_cal_np): &lt;class &#39;numpy.ndarray&#39;&gt;
background_cal_np.shape: (100, 8)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\shapiq\explainer\validation.py:88: UserWarning: Mismatch between max_order=1 and index=k-SII. k-SII generalizes &#39;SV&#39;. Setting index to &#39;SV&#39;.
  validated_index = validate_index(index, max_order)
C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\shapiq\explainer\validation.py:88: UserWarning: Mismatch between max_order=1 and index=k-SII. k-SII generalizes &#39;SV&#39;. Setting index to &#39;SV&#39;.
  validated_index = validate_index(index, max_order)
C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\shapiq\explainer\validation.py:88: UserWarning: Mismatch between max_order=1 and index=k-SII. k-SII generalizes &#39;SV&#39;. Setting index to &#39;SV&#39;.
  validated_index = validate_index(index, max_order)
C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\shapiq\explainer\validation.py:88: UserWarning: Mismatch between max_order=1 and index=k-SII. k-SII generalizes &#39;SV&#39;. Setting index to &#39;SV&#39;.
  validated_index = validate_index(index, max_order)
C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\shapiq\explainer\validation.py:88: UserWarning: Mismatch between max_order=1 and index=k-SII. k-SII generalizes &#39;SV&#39;. Setting index to &#39;SV&#39;.
  validated_index = validate_index(index, max_order)
C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\shapiq\explainer\validation.py:88: UserWarning: Mismatch between max_order=1 and index=k-SII. k-SII generalizes &#39;SV&#39;. Setting index to &#39;SV&#39;.
  validated_index = validate_index(index, max_order)
C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\shapiq\explainer\validation.py:88: UserWarning: Mismatch between max_order=1 and index=k-SII. k-SII generalizes &#39;SV&#39;. Setting index to &#39;SV&#39;.
  validated_index = validate_index(index, max_order)
C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\shapiq\explainer\validation.py:88: UserWarning: Mismatch between max_order=1 and index=k-SII. k-SII generalizes &#39;SV&#39;. Setting index to &#39;SV&#39;.
  validated_index = validate_index(index, max_order)
C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\shapiq\explainer\validation.py:88: UserWarning: Mismatch between max_order=1 and index=k-SII. k-SII generalizes &#39;SV&#39;. Setting index to &#39;SV&#39;.
  validated_index = validate_index(index, max_order)
C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\shapiq\explainer\validation.py:88: UserWarning: Mismatch between max_order=1 and index=k-SII. k-SII generalizes &#39;SV&#39;. Setting index to &#39;SV&#39;.
  validated_index = validate_index(index, max_order)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Alle Explainer (shapiq + shap) erfolgreich initialisiert.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\shapiq\explainer\validation.py:88: UserWarning: Mismatch between max_order=1 and index=k-SII. k-SII generalizes &#39;SV&#39;. Setting index to &#39;SV&#39;.
  validated_index = validate_index(index, max_order)
C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\shapiq\explainer\validation.py:88: UserWarning: Mismatch between max_order=1 and index=k-SII. k-SII generalizes &#39;SV&#39;. Setting index to &#39;SV&#39;.
  validated_index = validate_index(index, max_order)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">l1_error</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">l2_error</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">benchmark_shap_explainers</span><span class="p">(</span><span class="n">explainers</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">ref_shap_values</span><span class="p">,</span> <span class="n">budget</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n_samples</span><span class="p">,</span> <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>

    <span class="k">assert</span> <span class="n">ref_shap_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">n_samples</span><span class="p">,</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;[Fehler] Anzahl Zeilen stimmt nicht überein: X hat </span><span class="si">{</span><span class="n">n_samples</span><span class="si">}</span><span class="s2">, Referenz hat </span><span class="si">{</span><span class="n">ref_shap_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="k">assert</span> <span class="n">ref_shap_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">n_features</span><span class="p">,</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;[Fehler] Anzahl Features stimmt nicht überein: X hat </span><span class="si">{</span><span class="n">n_features</span><span class="si">}</span><span class="s2">, Referenz hat </span><span class="si">{</span><span class="n">ref_shap_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">explainer</span> <span class="ow">in</span> <span class="n">explainers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;→ Benchmarking: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">shap_values_list</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="c1"># Compute SHAP values</span>
                <span class="n">shap_i</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">explain</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">budget</span><span class="o">=</span><span class="n">budget</span><span class="p">)</span>
                <span class="n">shap_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">shap_i</span><span class="p">)</span>

                <span class="c1"># 🔍 DEBUG: Print actual shape and type</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[Debug] Sample </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">, Explainer &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;:&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;         SHAP output shape: </span><span class="si">{</span><span class="n">shap_i</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;         Expected shape: (</span><span class="si">{</span><span class="n">n_features</span><span class="si">}</span><span class="s2">,)&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;         SHAP type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">shap_i</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="c1"># Check dimensionality</span>
                <span class="k">if</span> <span class="n">shap_i</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">shap_i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">n_features</span><span class="p">:</span>
                        <span class="n">shap_i</span> <span class="o">=</span> <span class="n">shap_i</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[Fehler bei </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">]: SHAP-Array hat falsche Länge: </span><span class="si">{</span><span class="n">shap_i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> statt </span><span class="si">{</span><span class="n">n_features</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">shap_i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">shap_i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">n_features</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[Fehler bei </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">]: Unerwartete SHAP-Form einzelner Instanz: </span><span class="si">{</span><span class="n">shap_i</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="n">shap_values_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shap_i</span><span class="p">)</span>

            <span class="c1"># Stack all SHAP values</span>
            <span class="n">shap_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">shap_values_list</span><span class="p">)</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

            <span class="k">if</span> <span class="n">shap_values</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">n_features</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[Fehler bei </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">]: Finale SHAP-Form ist </span><span class="si">{</span><span class="n">shap_values</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, erwartet </span><span class="si">{</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span><span class="w"> </span><span class="n">n_features</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Compute L2 error</span>
            <span class="n">l2_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">shap_values</span> <span class="o">-</span> <span class="n">ref_shap_values</span><span class="p">)</span>

            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                <span class="s2">&quot;l2_error&quot;</span><span class="p">:</span> <span class="n">l2_error</span><span class="p">,</span>
                <span class="s2">&quot;duration_sec&quot;</span><span class="p">:</span> <span class="n">duration</span><span class="p">,</span>
            <span class="p">})</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[Fehler bei </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">]: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                <span class="s2">&quot;l2_error&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
                <span class="s2">&quot;duration_sec&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="p">})</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<br/><br/></pre></div>
</div>
</div>
<p>shapley</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">timeit</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">duration</span>

<span class="n">ref_sample_size</span> <span class="o">=</span> <span class="mi">50</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Berechne Referenz-Shapley-Werte (KernelExplainer)...&quot;</span><span class="p">)</span>

<span class="n">ref_shap_bike_rf</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">timeit</span><span class="p">(</span>
    <span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">explainer_shap_kernel_bike_rf</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">X_bike_proc_sampled</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">ref_sample_size</span><span class="p">]))</span>
<span class="p">)</span>

<span class="n">ref_shap_cal_rf</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">timeit</span><span class="p">(</span>
    <span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">explainer_shap_kernel_cal_rf</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">X_cal_proc_sampled</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">ref_sample_size</span><span class="p">]))</span>
<span class="p">)</span>

<span class="n">ref_shap_bike_lr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">timeit</span><span class="p">(</span>
    <span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">explainer_shap_kernel_bike_lr</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">X_bike_proc_sampled</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">ref_sample_size</span><span class="p">]))</span>
<span class="p">)</span>

<span class="n">ref_shap_cal_lr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">timeit</span><span class="p">(</span>
    <span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">explainer_shap_kernel_cal_lr</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">X_cal_proc_sampled</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">ref_sample_size</span><span class="p">]))</span>
<span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Berechne Referenz-Shapley-Werte (KernelExplainer)...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "dc43b39a37164b678ac5b676b3cd1fe5"}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "df592fbc61f5445f93924259e5eed1e4"}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "8ecb54b8195c45849841f7f20e98bca0"}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "b7702607dcb242808db23057ee9302ff"}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">validate_shapes</span><span class="p">(</span><span class="n">ref_dict</span><span class="p">,</span> <span class="n">n_expected</span><span class="p">,</span> <span class="n">n_features_expected</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starte Validierung...&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">ref_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;→ </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">arr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Fehler: None&quot;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;object&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Fehler: dtype=object&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Fehler: NaN enthalten&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Fehler: Nicht 2D (shape=</span><span class="si">{</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">n_expected</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Warnung: </span><span class="si">{</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> Zeilen, erwartet: </span><span class="si">{</span><span class="n">n_expected</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">n_features_expected</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Warnung: </span><span class="si">{</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> Features, erwartet: </span><span class="si">{</span><span class="n">n_features_expected</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  OK: shape=</span><span class="si">{</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, dtype=</span><span class="si">{</span><span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">validate_shapes</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;ref_shap_bike_rf&quot;</span><span class="p">:</span> <span class="n">ref_shap_bike_rf</span><span class="p">,</span>
        <span class="s2">&quot;ref_shap_bike_lr&quot;</span><span class="p">:</span> <span class="n">ref_shap_bike_lr</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">n_expected</span><span class="o">=</span><span class="n">ref_sample_size</span><span class="p">,</span>
    <span class="n">n_features_expected</span><span class="o">=</span><span class="n">X_bike_proc_sampled</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">validate_shapes</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;ref_shap_cal_rf&quot;</span><span class="p">:</span> <span class="n">ref_shap_cal_rf</span><span class="p">,</span>
        <span class="s2">&quot;ref_shap_cal_lr&quot;</span><span class="p">:</span> <span class="n">ref_shap_cal_lr</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">n_expected</span><span class="o">=</span><span class="n">ref_sample_size</span><span class="p">,</span>
    <span class="n">n_features_expected</span><span class="o">=</span><span class="n">X_cal_proc_sampled</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># --- Explainer-Dictionaries ---</span>
<span class="n">explainers_bike_rf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;shapiq_spex&quot;</span><span class="p">:</span> <span class="n">explainer_shapiq_spex_bike_rf</span><span class="p">,</span>
    <span class="s2">&quot;shapiq_svarm&quot;</span><span class="p">:</span> <span class="n">explainer_shapiq_svarm_bike_rf</span><span class="p">,</span>
    <span class="s2">&quot;shapiq_perm&quot;</span><span class="p">:</span> <span class="n">explainer_shapiq_perm_bike_rf</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">explainers_cal_rf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;shapiq_spex&quot;</span><span class="p">:</span> <span class="n">explainer_shapiq_spex_cal_rf</span><span class="p">,</span>
    <span class="s2">&quot;shapiq_svarm&quot;</span><span class="p">:</span> <span class="n">explainer_shapiq_svarm_cal_rf</span><span class="p">,</span>
    <span class="s2">&quot;shapiq_perm&quot;</span><span class="p">:</span> <span class="n">explainer_shapiq_perm_cal_rf</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">explainers_bike_lr</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;shapiq_spex&quot;</span><span class="p">:</span> <span class="n">explainer_shapiq_spex_bike_lr</span><span class="p">,</span>
    <span class="s2">&quot;shapiq_svarm&quot;</span><span class="p">:</span> <span class="n">explainer_shapiq_svarm_bike_lr</span><span class="p">,</span>
    <span class="s2">&quot;shapiq_perm&quot;</span><span class="p">:</span> <span class="n">explainer_shapiq_perm_bike_lr</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">explainers_cal_lr</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;shapiq_spex&quot;</span><span class="p">:</span> <span class="n">explainer_shapiq_spex_cal_lr</span><span class="p">,</span>
    <span class="s2">&quot;shapiq_svarm&quot;</span><span class="p">:</span> <span class="n">explainer_shapiq_svarm_cal_lr</span><span class="p">,</span>
    <span class="s2">&quot;shapiq_perm&quot;</span><span class="p">:</span> <span class="n">explainer_shapiq_perm_cal_lr</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># --- Benchmark ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Benchmark: Bike Sharing - RandomForest&quot;</span><span class="p">)</span>
<span class="n">X_benchmark</span> <span class="o">=</span> <span class="n">X_bike_proc_sampled</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">ref_shap_bike_rf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">results_bike_rf</span> <span class="o">=</span> <span class="n">benchmark_shap_explainers</span><span class="p">(</span><span class="n">explainers_bike_rf</span><span class="p">,</span> <span class="n">X_benchmark</span><span class="p">,</span> <span class="n">ref_shap_bike_rf</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Benchmark: California Housing - RandomForest&quot;</span><span class="p">)</span>
<span class="n">X_benchmark_cal</span> <span class="o">=</span> <span class="n">X_cal_proc_sampled</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">ref_shap_cal_rf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">results_cal_rf</span> <span class="o">=</span> <span class="n">benchmark_shap_explainers</span><span class="p">(</span><span class="n">explainers_cal_rf</span><span class="p">,</span> <span class="n">X_benchmark_cal</span><span class="p">,</span> <span class="n">ref_shap_cal_rf</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Benchmark: Bike Sharing - LinearRegression&quot;</span><span class="p">)</span>
<span class="n">X_benchmark_bike_lr</span> <span class="o">=</span> <span class="n">X_bike_proc_sampled</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">ref_shap_bike_lr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">results_bike_lr</span> <span class="o">=</span> <span class="n">benchmark_shap_explainers</span><span class="p">(</span><span class="n">explainers_bike_lr</span><span class="p">,</span> <span class="n">X_benchmark_bike_lr</span><span class="p">,</span> <span class="n">ref_shap_bike_lr</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Benchmark: California Housing - LinearRegression&quot;</span><span class="p">)</span>
<span class="n">X_benchmark_cal_lr</span> <span class="o">=</span> <span class="n">X_cal_proc_sampled</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">ref_shap_cal_lr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">results_cal_lr</span> <span class="o">=</span> <span class="n">benchmark_shap_explainers</span><span class="p">(</span><span class="n">explainers_cal_lr</span><span class="p">,</span> <span class="n">X_benchmark_cal_lr</span><span class="p">,</span> <span class="n">ref_shap_cal_lr</span><span class="p">)</span>

<span class="n">results_dfs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; | Bike-RF&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="p">[</span><span class="n">results_bike_rf</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span>
<span class="p">]</span> <span class="o">+</span> <span class="p">[</span>
    <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; | Bike-LR&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="p">[</span><span class="n">results_bike_lr</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span>
<span class="p">]</span> <span class="o">+</span> <span class="p">[</span>
    <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; | Cal-RF&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="p">[</span><span class="n">results_cal_rf</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span>
<span class="p">]</span> <span class="o">+</span> <span class="p">[</span>
    <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; | Cal-LR&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="p">[</span><span class="n">results_cal_lr</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span>
<span class="p">]</span>

<span class="n">df_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">results_dfs</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># --- Zusammenführen ---</span>
<span class="n">results_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">results_bike_rf</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="n">results_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results_bike_rf</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; | Bike-RF&quot;</span><span class="p">))</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">results_bike_lr</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="n">results_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results_bike_lr</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; | Bike-LR&quot;</span><span class="p">))</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">results_cal_rf</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="n">results_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results_cal_rf</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; | Cal-RF&quot;</span><span class="p">))</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">results_cal_lr</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="n">results_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results_cal_lr</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; | Cal-LR&quot;</span><span class="p">))</span>

<span class="n">df_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">results_list</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ergebnisse (Beispiel, SVARM):&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_results</span><span class="p">[</span><span class="n">df_results</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;svarm&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Benchmark abgeschlossen.&quot;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Starte Validierung...
→ ref_shap_bike_rf
  OK: shape=(50, 16), dtype=float64
→ ref_shap_bike_lr
  OK: shape=(50, 16), dtype=float64
Starte Validierung...
→ ref_shap_cal_rf
  OK: shape=(50, 8), dtype=float64
→ ref_shap_cal_lr
  OK: shape=(50, 8), dtype=float64
Benchmark: Bike Sharing - RandomForest
→ Benchmarking: shapiq_spex
[Debug] Sample 0, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (11,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Fehler bei shapiq_spex]: [Fehler bei shapiq_spex]: SHAP-Array hat falsche Länge: 11 statt 16
→ Benchmarking: shapiq_svarm
[Debug] Sample 0, Explainer &#39;shapiq_svarm&#39;:
         SHAP output shape: (17,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Fehler bei shapiq_svarm]: [Fehler bei shapiq_svarm]: SHAP-Array hat falsche Länge: 17 statt 16
→ Benchmarking: shapiq_perm
[Debug] Sample 0, Explainer &#39;shapiq_perm&#39;:
         SHAP output shape: (17,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Fehler bei shapiq_perm]: [Fehler bei shapiq_perm]: SHAP-Array hat falsche Länge: 17 statt 16
Benchmark: California Housing - RandomForest
→ Benchmarking: shapiq_spex
[Debug] Sample 0, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (9,)
         Expected shape: (8,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Fehler bei shapiq_spex]: [Fehler bei shapiq_spex]: SHAP-Array hat falsche Länge: 9 statt 8
→ Benchmarking: shapiq_svarm
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\shapiq\approximator\montecarlo\base.py:104: UserWarning: Not all budget is required due to the border-trick.
  self._sampler.sample(budget)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[Debug] Sample 0, Explainer &#39;shapiq_svarm&#39;:
         SHAP output shape: (9,)
         Expected shape: (8,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Fehler bei shapiq_svarm]: [Fehler bei shapiq_svarm]: SHAP-Array hat falsche Länge: 9 statt 8
→ Benchmarking: shapiq_perm
[Debug] Sample 0, Explainer &#39;shapiq_perm&#39;:
         SHAP output shape: (9,)
         Expected shape: (8,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Fehler bei shapiq_perm]: [Fehler bei shapiq_perm]: SHAP-Array hat falsche Länge: 9 statt 8
Benchmark: Bike Sharing - LinearRegression
→ Benchmarking: shapiq_spex
[Debug] Sample 0, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 1, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 2, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 3, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 4, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 5, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 6, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 7, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 8, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 9, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 10, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 11, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 12, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 13, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 14, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 15, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 16, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 17, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 18, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 19, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 20, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 21, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 22, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 23, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 24, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 25, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 26, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 27, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 28, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 29, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 30, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 31, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 32, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 33, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 34, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 35, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 36, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 37, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 38, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 39, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 40, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 41, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 42, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 43, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 44, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 45, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 46, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 47, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 48, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Debug] Sample 49, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (16,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
→ Benchmarking: shapiq_svarm
[Debug] Sample 0, Explainer &#39;shapiq_svarm&#39;:
         SHAP output shape: (17,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Fehler bei shapiq_svarm]: [Fehler bei shapiq_svarm]: SHAP-Array hat falsche Länge: 17 statt 16
→ Benchmarking: shapiq_perm
[Debug] Sample 0, Explainer &#39;shapiq_perm&#39;:
         SHAP output shape: (17,)
         Expected shape: (16,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Fehler bei shapiq_perm]: [Fehler bei shapiq_perm]: SHAP-Array hat falsche Länge: 17 statt 16
Benchmark: California Housing - LinearRegression
→ Benchmarking: shapiq_spex
[Debug] Sample 0, Explainer &#39;shapiq_spex&#39;:
         SHAP output shape: (9,)
         Expected shape: (8,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Fehler bei shapiq_spex]: [Fehler bei shapiq_spex]: SHAP-Array hat falsche Länge: 9 statt 8
→ Benchmarking: shapiq_svarm
[Debug] Sample 0, Explainer &#39;shapiq_svarm&#39;:
         SHAP output shape: (9,)
         Expected shape: (8,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Fehler bei shapiq_svarm]: [Fehler bei shapiq_svarm]: SHAP-Array hat falsche Länge: 9 statt 8
→ Benchmarking: shapiq_perm
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\shapiq\approximator\montecarlo\base.py:104: UserWarning: Not all budget is required due to the border-trick.
  self._sampler.sample(budget)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[Debug] Sample 0, Explainer &#39;shapiq_perm&#39;:
         SHAP output shape: (9,)
         Expected shape: (8,)
         SHAP type: &lt;class &#39;numpy.ndarray&#39;&gt;
[Fehler bei shapiq_perm]: [Fehler bei shapiq_perm]: SHAP-Array hat falsche Länge: 9 statt 8
Ergebnisse (Beispiel, SVARM):
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>method</th>
      <th>l2_error</th>
      <th>duration_sec</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>shapiq_svarm | Bike-RF</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Benchmark abgeschlossen.
</pre></div></div>
</div>
<p>Ergebnisse in DataFrame</p>
<p>Visualisierung (Plotting)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_results</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;method&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;runtime&quot;</span><span class="p">,</span> <span class="n">errorbar</span><span class="o">=</span><span class="s1">&#39;sd&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Durchschnittliche Laufzeit je Methode und Datensatz&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Laufzeit (Sekunden)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Methode | Datensatz&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_results</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;method&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;quality&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Qualitätsfehler (L2-Abweichung) je Methode und Datensatz&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;L2-Abweichung zum Referenz&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Methode | Datensatz&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_results</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;method&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;runtime&quot;</span><span class="p">,</span> <span class="n">inner</span><span class="o">=</span><span class="s2">&quot;quartile&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Verteilung der Laufzeiten je Methode und Datensatz&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Laufzeit (Sekunden)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Methode | Datensatz&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_results</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;method&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;quality&quot;</span><span class="p">,</span> <span class="n">inner</span><span class="o">=</span><span class="s2">&quot;quartile&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightcoral&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Verteilung der Qualitätsfehler (L2) je Methode und Datensatz&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;L2-Abweichung zum Referenz&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Methode | Datensatz&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[11]</span><span class="ansi-green-fg">, line 2</span>
<span class="ansi-green-fg">      1</span> plt.figure(figsize=(<span class="ansi-green-fg">14</span>,<span class="ansi-green-fg">6</span>))
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">2</span> <span class="ansi-yellow-bg">sns</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">barplot</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">df_results</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">x</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-fg ansi-yellow-bg">&#34;</span><span class="ansi-yellow-fg ansi-yellow-bg">method</span><span class="ansi-yellow-fg ansi-yellow-bg">&#34;</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-fg ansi-yellow-bg">&#34;</span><span class="ansi-yellow-fg ansi-yellow-bg">runtime</span><span class="ansi-yellow-fg ansi-yellow-bg">&#34;</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">errorbar</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-fg ansi-yellow-bg">&#39;</span><span class="ansi-yellow-fg ansi-yellow-bg">sd</span><span class="ansi-yellow-fg ansi-yellow-bg">&#39;</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">      3</span> plt.xticks(rotation=<span class="ansi-green-fg">45</span>, ha=<span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">right</span><span class="ansi-yellow-fg">&#34;</span>)
<span class="ansi-green-fg">      4</span> plt.title(<span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">Durchschnittliche Laufzeit je Methode und Datensatz</span><span class="ansi-yellow-fg">&#34;</span>)

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\seaborn\categorical.py:2341</span>, in <span class="ansi-cyan-fg">barplot</span><span class="ansi-blue-fg">(data, x, y, hue, order, hue_order, estimator, errorbar, n_boot, seed, units, weights, orient, color, palette, saturation, fill, hue_norm, width, dodge, gap, log_scale, native_scale, formatter, legend, capsize, err_kws, ci, errcolor, errwidth, ax, **kwargs)</span>
<span class="ansi-green-fg">   2338</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> estimator <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span style="color: rgb(0,135,0)">len</span>:
<span class="ansi-green-fg">   2339</span>     estimator = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">size</span><span class="ansi-yellow-fg">&#34;</span>
<span class="ansi-green-fg">-&gt; </span><span class="ansi-green-fg">2341</span> p = <span class="ansi-yellow-bg">_CategoricalAggPlotter</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg">   2342</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">   2343</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">variables</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">dict</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">x</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">x</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">hue</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">hue</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">units</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">units</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">weight</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">weights</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">   2344</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">order</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">order</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">   2345</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">orient</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">orient</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">   2346</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">color</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">color</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">   2347</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">legend</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">legend</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">   2348</span> <span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">   2350</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> ax <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-fg">   2351</span>     ax = plt.gca()

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\seaborn\categorical.py:67</span>, in <span class="ansi-cyan-fg">_CategoricalPlotter.__init__</span><span class="ansi-blue-fg">(self, data, variables, order, orient, require_numeric, color, legend)</span>
<span class="ansi-green-fg">     56</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-blue-fg">__init__</span>(
<span class="ansi-green-fg">     57</span>     <span style="color: rgb(0,135,0)">self</span>,
<span class="ansi-green-fg">     58</span>     data=<span class="ansi-bold" style="color: rgb(0,135,0)">None</span>,
<span class="ansi-green-fg">   (...)</span><span class="ansi-green-fg">     64</span>     legend=<span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">auto</span><span class="ansi-yellow-fg">&#34;</span>,
<span class="ansi-green-fg">     65</span> ):
<span class="ansi-green-fg">---&gt; </span><span class="ansi-green-fg">67</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">super</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">.</span><span class="ansi-blue-fg ansi-yellow-bg">__init__</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">variables</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">variables</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">     69</span>     <span style="color: rgb(95,135,135)"># This method takes care of some bookkeeping that is necessary because the</span>
<span class="ansi-green-fg">     70</span>     <span style="color: rgb(95,135,135)"># original categorical plots (prior to the 2021 refactor) had some rules that</span>
<span class="ansi-green-fg">     71</span>     <span style="color: rgb(95,135,135)"># don&#39;t fit exactly into VectorPlotter logic. It may be wise to have a second</span>
<span class="ansi-green-fg">   (...)</span><span class="ansi-green-fg">     76</span>     <span style="color: rgb(95,135,135)"># default VectorPlotter rules. If we do decide to make orient part of the</span>
<span class="ansi-green-fg">     77</span>     <span style="color: rgb(95,135,135)"># _base variable assignment, we&#39;ll want to figure out how to express that.</span>
<span class="ansi-green-fg">     78</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span>.input_format == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">wide</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> orient <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> [<span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">h</span><span class="ansi-yellow-fg">&#34;</span>, <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#34;</span>]:

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\seaborn\_base.py:634</span>, in <span class="ansi-cyan-fg">VectorPlotter.__init__</span><span class="ansi-blue-fg">(self, data, variables)</span>
<span class="ansi-green-fg">    629</span> <span style="color: rgb(95,135,135)"># var_ordered is relevant only for categorical axis variables, and may</span>
<span class="ansi-green-fg">    630</span> <span style="color: rgb(95,135,135)"># be better handled by an internal axis information object that tracks</span>
<span class="ansi-green-fg">    631</span> <span style="color: rgb(95,135,135)"># such information and is set up by the scale_* methods. The analogous</span>
<span class="ansi-green-fg">    632</span> <span style="color: rgb(95,135,135)"># information for numeric axes would be information about log scales.</span>
<span class="ansi-green-fg">    633</span> <span style="color: rgb(0,135,0)">self</span>._var_ordered = {<span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">x</span><span class="ansi-yellow-fg">&#34;</span>: <span class="ansi-bold" style="color: rgb(0,135,0)">False</span>, <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">y</span><span class="ansi-yellow-fg">&#34;</span>: <span class="ansi-bold" style="color: rgb(0,135,0)">False</span>}  <span style="color: rgb(95,135,135)"># alt., used DefaultDict</span>
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">634</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">assign_variables</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">variables</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    636</span> <span style="color: rgb(95,135,135)"># TODO Lots of tests assume that these are called to initialize the</span>
<span class="ansi-green-fg">    637</span> <span style="color: rgb(95,135,135)"># mappings to default values on class initialization. I&#39;d prefer to</span>
<span class="ansi-green-fg">    638</span> <span style="color: rgb(95,135,135)"># move away from that and only have a mapping when explicitly called.</span>
<span class="ansi-green-fg">    639</span> <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> var <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> [<span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">hue</span><span class="ansi-yellow-fg">&#34;</span>, <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">size</span><span class="ansi-yellow-fg">&#34;</span>, <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">style</span><span class="ansi-yellow-fg">&#34;</span>]:

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\seaborn\_base.py:679</span>, in <span class="ansi-cyan-fg">VectorPlotter.assign_variables</span><span class="ansi-blue-fg">(self, data, variables)</span>
<span class="ansi-green-fg">    674</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">    675</span>     <span style="color: rgb(95,135,135)"># When dealing with long-form input, use the newer PlotData</span>
<span class="ansi-green-fg">    676</span>     <span style="color: rgb(95,135,135)"># object (internal but introduced for the objects interface)</span>
<span class="ansi-green-fg">    677</span>     <span style="color: rgb(95,135,135)"># to centralize / standardize data consumption logic.</span>
<span class="ansi-green-fg">    678</span>     <span style="color: rgb(0,135,0)">self</span>.input_format = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">long</span><span class="ansi-yellow-fg">&#34;</span>
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">679</span>     plot_data = <span class="ansi-yellow-bg">PlotData</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">variables</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    680</span>     frame = plot_data.frame
<span class="ansi-green-fg">    681</span>     names = plot_data.names

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\seaborn\_core\data.py:58</span>, in <span class="ansi-cyan-fg">PlotData.__init__</span><span class="ansi-blue-fg">(self, data, variables)</span>
<span class="ansi-green-fg">     51</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-blue-fg">__init__</span>(
<span class="ansi-green-fg">     52</span>     <span style="color: rgb(0,135,0)">self</span>,
<span class="ansi-green-fg">     53</span>     data: DataSource,
<span class="ansi-green-fg">     54</span>     variables: <span style="color: rgb(0,135,0)">dict</span>[<span style="color: rgb(0,135,0)">str</span>, VariableSpec],
<span class="ansi-green-fg">     55</span> ):
<span class="ansi-green-fg">     57</span>     data = handle_data_source(data)
<span class="ansi-green-fg">---&gt; </span><span class="ansi-green-fg">58</span>     frame, names, ids = <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_assign_variables</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">variables</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">     60</span>     <span style="color: rgb(0,135,0)">self</span>.frame = frame
<span class="ansi-green-fg">     61</span>     <span style="color: rgb(0,135,0)">self</span>.names = names

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">C:\YanLiu\coding_projects\pythonProjs\sep-aiml-25\.venv\Lib\site-packages\seaborn\_core\data.py:232</span>, in <span class="ansi-cyan-fg">PlotData._assign_variables</span><span class="ansi-blue-fg">(self, data, variables)</span>
<span class="ansi-green-fg">    230</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">    231</span>         err += <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">An entry with this name does not appear in `data`.</span><span class="ansi-yellow-fg">&#34;</span>
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">232</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">ValueError</span>(err)
<span class="ansi-green-fg">    234</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">    235</span>
<span class="ansi-green-fg">    236</span>     <span style="color: rgb(95,135,135)"># Otherwise, assume the value somehow represents data</span>
<span class="ansi-green-fg">    237</span>
<span class="ansi-green-fg">    238</span>     <span style="color: rgb(95,135,135)"># Ignore empty data structures</span>
<span class="ansi-green-fg">    239</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(val, Sized) <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> <span style="color: rgb(0,135,0)">len</span>(val) == <span class="ansi-green-fg">0</span>:

<span class="ansi-red-fg">ValueError</span>: Could not interpret value `runtime` for `y`. An entry with this name does not appear in `data`.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Figure size 1400x600 with 0 Axes&gt;
</pre></div></div>
</div>
</section>
</section>
<section id="Fazit">
<h2>Fazit<a class="headerlink" href="#Fazit" title="Link to this heading">¶</a></h2>
<p>Bei der Ausführung der SHAP-Benchmarks sind unerwartet lange Laufzeiten aufgetreten, insbesondere beim Einsatz des KernelExplainer. Dies könnte auf die hohe Rechenintensität dieses Explainers zurückzuführen sein, der für größere Datensätze oder komplexe Modelle unverhältnismäßig viel Zeit in Anspruch genommen hat.</p>
<p>Es wurde festgestellt, dass TreeExplainer und LinearExplainer wesentlich schneller laufen, was diese Methoden für größere Datensätze oder Echtzeitanwendungen besser geeignet macht. Der KernelExplainer hingegen sollte nur mit kleineren Datensätzen genutzt werden.</p>
<p>Für zukünftige Tests könnte es sinnvoll sein, kleinere Teildatensätze zu verwenden oder die Hardwareanforderungen zu überprüfen, um die Laufzeit zu verkürzen. Eine zusätzliche Optimierung des Codes muss ebenfalls notwendig sein, um die richtige Berechnung ausführen zu können.</p>
<p>Zusammenfassend lässt sich sagen, dass trotz implementierter Funktionen und Methoden zur Analyse eine signifikante Laufzeitproblematik besteht, was allerdings nur eine Vermutung ist, da ein korrekter Vergleich aus verschieden Gründen nicht möglich war.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../api.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">📖 API Reference</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="coalition_finding_algorithmus.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Coalition-Finding Algorithmus</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Sep-AIML-25-Group-2
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Laufzeitanalyse: SHAP vs SHAPIQ</a><ul>
<li><a class="reference internal" href="#Ziel">Ziel</a><ul>
<li><a class="reference internal" href="#Verglichene-Methoden">Verglichene Methoden</a></li>
<li><a class="reference internal" href="#Datensätze">Datensätze</a></li>
<li><a class="reference internal" href="#Modelle">Modelle</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Fazit">Fazit</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=8fa8b3e9"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>